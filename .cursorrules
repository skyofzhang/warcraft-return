# Warcraft Return - Cursor AI Rules V1.1.1
# MT Project AI Development Protocol
# Updated: 2026-02-05

## Project Info
- Project: MT Warcraft Return
- Engine: Unity 2022.3.47f1c1
- Unity Path: D:\program\2022.3.47f1c1\Editor\Unity.exe
- Project Path: E:\AI_Project\MT
- Platform: Android ARM64
- Render Pipeline: URP14

## Development Flow

### 1. Read on Startup
- .task/current_task.json
- .task/PROTOCOL.json

### 2. Task Execution Rules
- Follow acceptance_criteria strictly
- Check existing code before modifying (70+ files exist)
- Understand dependencies before changes

### 3. Git Commit Tags
- Task done: git commit -m "[NODE_COMPLETE] MT-XXX: description"
- Progress: git commit -m "[PROGRESS] MT-XXX: description"
- Question: write .task/ask_claude.json then git commit -m "[ASK_CLAUDE] question"
- Always: git push origin main

### 4. Screenshot Verification
- Save to .task/screenshots/MT-XXX.png
- Update .task/task_result.json

## Terminal Rules (PowerShell)
- Use ; to chain commands (not and-and)
- Quote paths with spaces
- Use Remove-Item for deletion
- Use Copy-Item for copying

## Auto Build SOP

### Step 1: Close Unity GUI
Get-Process -Name "Unity" -ErrorAction SilentlyContinue | Stop-Process -Force; Start-Sleep -Seconds 5

### Step 2: Build Command
and "D:\program\2022.3.47f1c1\Editor\Unity.exe" -batchmode -nographics -projectPath "E:\AI_Project\MT" -executeMethod BuildScript.BuildFromCommandLine -quit -logFile "E:\AI_Project\MT\build.log"

### Step 3: Wait for Build
while (Get-Process -Name "Unity" -ErrorAction SilentlyContinue) { Start-Sleep -Seconds 10 }

### Step 4: Check Result
if (Test-Path "E:\AI_Project\MT\Builds\Android\WarcraftReturn.apk") { Write-Host "BUILD SUCCESS" } else { Write-Host "BUILD FAILED"; Get-Content "E:\AI_Project\MT\build.log" -Tail 50 }

### Step 5: Reopen Unity
Start-Process "D:\program\2022.3.47f1c1\Editor\Unity.exe" -ArgumentList "-projectPath","E:\AI_Project\MT"

### Troubleshooting
- Another Unity instance: Run Step 1 first, increase Sleep time
- Compile errors: Check build.log last 50 lines
- Missing BuildScript: Verify Assets/Editor/BuildScript.cs exists

## Project Architecture
Assets/Scripts/
  Core/ - GameManager(22KB), BootLoader, EventManager, ConfigManager(15KB), SaveSystem, PlayerStats
  Combat/ - CombatSystem, BattleVfxManager, CameraShakeOnDamage, HitFlash
  Gameplay/ - PlayerController, MonsterController, CharacterVisualFactory
  Systems/ - EquipmentManager, InventoryService, LootManager, MonsterSpawner, DropPickup
  UI/ - UIManager, MainMenuPanel, GameplayPanel, InventoryPanel, ShopPanel, SkillsPanel, 10+ panels
  Data/ - ConfigDataClasses, SaveDataClasses, IStatsProvider, StatType
  Environment/ - WangZheCanyonMapBuilder, TextureScroll, MapVersionMarker

Assets/Scenes/
  Boot.unity - Boot scene
  MainMenu.unity - Main menu
  Gameplay.unity - Battle scene

## Critical Notes
- 70+ C# files exist - DO NOT recreate existing classes
- Read files before modifying to understand existing logic
- GameManager.cs is core (22KB) - modify carefully
- ConfigManager.cs handles config (15KB) - modify carefully
- Uses WarcraftReturn.asmdef assembly definition

## Quality Standards
- Zero compile errors
- No NullReferenceException at runtime
- Target 60fps, Memory under 200MB, APK under 100MB
